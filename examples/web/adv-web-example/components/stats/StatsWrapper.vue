<template>
  <el-card>
    <template #header>
      <div class="card-header">Golem Network Stats</div>
    </template>
    <el-tabs v-model="activeTab">
      <el-tab-pane label="Providers" name="providers">
        <StatsProviderCard :providers="statsTree.providers" />
      </el-tab-pane>
      <el-tab-pane label="Allocations" name="allocations">
        <StatsAllocationCard :allocations="statsTree.allocations" />
      </el-tab-pane>
    </el-tabs>
  </el-card>
</template>
<script setup>
import { StatsService } from "../../../../../dist/yajsapi.min.js";

const props = defineProps({
  yaJsEventTarget: EventTarget,
  logger: Object,
});

let statsTree = reactive({
  allocations: [],
  providers: [],
});

const activeTab = ref("providers");

const statService = new StatsService({ eventTarget: props.yaJsEventTarget, logger: props.logger });
statService.run();
setInterval(() => {
  let tmpStatsTree = statService.getStatsTree();
  statsTree.allocations = tmpStatsTree.allocations;
  statsTree.providers = tmpStatsTree.providers;
}, 1000);

// statsTree = JSON.parse(
//   '{"allocations":[{"id":"06d620b7-1d75-41b8-ad53-833edab3a330","amount":1,"platform":"erc20-rinkeby-tglm"}],"providers":[{"id":"0xe1ba9248dd9f6631fa09ee65b53a669774d8fdb1","providerName":"unknown","proposals":[{"id":"R-7f05d06a6c902fb1e07237187b47172c17e7c16431890d23d78a96d7eff6e6aa","providerId":"0xe1ba9248dd9f6631fa09ee65b53a669774d8fdb1","agreement":null}]},{"id":"0x6e53d47fa38d9e768fabc0b6ad42910148ffbc4b","providerName":"unknown","proposals":[{"id":"R-a4520d01a75724103802d7ccdb711db17ac7e29c725cd9e8a5156dc99ca506c1","providerId":"0x6e53d47fa38d9e768fabc0b6ad42910148ffbc4b","agreement":null},{"id":"R-d6a81d011f7f8aa4d75e21444b060063b39d3a3271e1ff2de2796eacf274964b","providerId":"0x6e53d47fa38d9e768fabc0b6ad42910148ffbc4b","agreement":null}]},{"id":"0xe61444655190f8bee2401f6e13d8a41ae00d2c70","providerName":"unknown","proposals":[{"id":"R-ee91f6cfe0150f655088018f6685e1932cb0b6eab2be28f655a2d88a53964c6b","providerId":"0xe61444655190f8bee2401f6e13d8a41ae00d2c70","agreement":null}]},{"id":"0x114e4ec2b33cb86a4e866ee95efcf12bde9dd5c7","providerName":"unknown","proposals":[{"id":"R-b06559085d1d40fc5e7e6ff0e51c4957bbf04fe02b84601d0393dd019303526d","providerId":"0x114e4ec2b33cb86a4e866ee95efcf12bde9dd5c7","agreement":null},{"id":"R-5f0586bc3a6d7bdee04ed3b934dcdea82215b6a21a8b618dfd0e760a71f38817","providerId":"0x114e4ec2b33cb86a4e866ee95efcf12bde9dd5c7","agreement":null}]},{"id":"0xc327483fd029b19d0fa7a9a378a8cdbf0ae5a97f","providerName":"unknown","proposals":[{"id":"R-30941625105483e26089b6e1737651ef98720a9202cc1694094015db87135432","providerId":"0xc327483fd029b19d0fa7a9a378a8cdbf0ae5a97f","agreement":null},{"id":"R-7206b7a9946a3fe10a1f46f509f460d375632bf0b5ac9bb1104b483cffd85301","providerId":"0xc327483fd029b19d0fa7a9a378a8cdbf0ae5a97f","agreement":null}]},{"id":"0x7a66c99526899f9e01c275e0cefc18e011238497","providerName":"unknown","proposals":[{"id":"R-63bb52167f270f99b4bd0b09b0b734ef2d4b4d8ba8461297f2abaf6506fe6464","providerId":"0x7a66c99526899f9e01c275e0cefc18e011238497","agreement":null}]},{"id":"0xccb9504c3a8fdb3a6984eb514112676829aa4202","providerName":"unknown","proposals":[{"id":"R-562e65cd3fb1e68d42acce3a52a6dad0947f503d95cff81cdee0fc04346121fe","providerId":"0xccb9504c3a8fdb3a6984eb514112676829aa4202","agreement":null}]},{"id":"0x992d2099e3e0d48ebe7e5686a28f9117f3812a67","providerName":"unknown","proposals":[{"id":"R-c9548ae836a3c8077792457424cf456006d3bc0dbfca79cc8d041a737504a0af","providerId":"0x992d2099e3e0d48ebe7e5686a28f9117f3812a67","agreement":null}]},{"id":"0x52b10b8d1e7dc4891a435b932f2b6992c899d18a","providerName":"golem2005.h","proposals":[{"id":"R-4c23fb726c87ff23d670787d4aba98505667521dfad47064f4729e1763d6e5bc","providerId":"0x52b10b8d1e7dc4891a435b932f2b6992c899d18a","agreement":null},{"id":"R-52dd5a7bc2a5e4b82fcc4cece91b8fd179652501ee8e35574cf39cda5ca76462","providerId":"0x52b10b8d1e7dc4891a435b932f2b6992c899d18a","agreement":{"id":"7bba1a1f461f78a253ddb7902a3884cb65df71298a0048d20efa8ed0b1ee9c30","providerId":"0x52b10b8d1e7dc4891a435b932f2b6992c899d18a","proposalId":"R-52dd5a7bc2a5e4b82fcc4cece91b8fd179652501ee8e35574cf39cda5ca76462","status":"confirmed","activities":[{"id":"4c8c9cb6760844e2a5a73ba667f2e754","taskId":"1","agreementId":"7bba1a1f461f78a253ddb7902a3884cb65df71298a0048d20efa8ed0b1ee9c30","task":{"id":"1","startTime":41211,"agreementId":"7bba1a1f461f78a253ddb7902a3884cb65df71298a0048d20efa8ed0b1ee9c30","stopTime":42363.09999990463,"retriesCount":0,"status":"rejected","reason":"appendResults is not defined"}}],"invoices":[{"id":"210f5c04-67ff-4561-926a-81eaf6ad66b6","providerId":"0x52b10b8d1e7dc4891a435b932f2b6992c899d18a","agreementId":"7bba1a1f461f78a253ddb7902a3884cb65df71298a0048d20efa8ed0b1ee9c30","amount":0.00040744735355}],"payments":[{"id":"210f5c04-67ff-4561-926a-81eaf6ad66b6","providerId":"0x52b10b8d1e7dc4891a435b932f2b6992c899d18a","agreementId":"7bba1a1f461f78a253ddb7902a3884cb65df71298a0048d20efa8ed0b1ee9c30","amount":0.00040744735355}]}},{"id":"R-4c2bf771dce52a1b59c34d7dd94df083806b6b641d8695c72b813f1c9a7e0a78","providerId":"0x52b10b8d1e7dc4891a435b932f2b6992c899d18a","agreement":null},{"id":"R-01bd65d14a0be12e28cd993e7e896d261efdc89748bb974b97c03d94b390f9d6","providerId":"0x52b10b8d1e7dc4891a435b932f2b6992c899d18a","agreement":null}]},{"id":"0xa569c2fc7757a0235bb02de7897a715536ebc698","providerName":"unknown","proposals":[{"id":"R-7bee07dbd3f79f0a6fc357ddf90e9270e6ed58e4088dd977719c7b78664e67ad","providerId":"0xa569c2fc7757a0235bb02de7897a715536ebc698","agreement":null},{"id":"R-2518ac944ca8b545532e5cef1a381bc9b3fc840e313632524502af85d75b6b1b","providerId":"0xa569c2fc7757a0235bb02de7897a715536ebc698","agreement":null}]},{"id":"0xa5d358145d361910657db4ff148c043c4b271c7d","providerName":"unknown","proposals":[{"id":"R-0d1e815a3104b38d0972d21fa1798e63635d2fd03201acb78d641f906db3c840","providerId":"0xa5d358145d361910657db4ff148c043c4b271c7d","agreement":null}]},{"id":"0xc715f4833db14d20c13f82f0559eeca56ffe3451","providerName":"unknown","proposals":[{"id":"R-31e03a8856808a6aab52e7fdb0e6caebf1505624ac020d0abbf34c5df31f1b32","providerId":"0xc715f4833db14d20c13f82f0559eeca56ffe3451","agreement":null},{"id":"R-138a216c12cfcd6904a5c09c5675b58c9948380e4096859aa3d520579cd24115","providerId":"0xc715f4833db14d20c13f82f0559eeca56ffe3451","agreement":null}]},{"id":"0x87af9bf7c7e8f37ef091b86d245c119fe5acabba","providerName":"unknown","proposals":[{"id":"R-442a664ccd8a54260f53f56cd03dd705a43baf7b72d6e5fadb562aa3bd10c9a3","providerId":"0x87af9bf7c7e8f37ef091b86d245c119fe5acabba","agreement":null}]},{"id":"0xed827a418ddd23ead600ce8c4d1fed662a330fdf","providerName":"unknown","proposals":[{"id":"R-291514cfa37118e32605b10621030cb7c37bc42f2d3cd97f3212b690c6fae9bf","providerId":"0xed827a418ddd23ead600ce8c4d1fed662a330fdf","agreement":null}]},{"id":"0x85f85b8c071a5b2fea0eee7e0c824ace51ba469f","providerName":"unknown","proposals":[{"id":"R-75e1973a8ce52f67e2e8b7e83b57216af723823ac47eb18413c9e8ba0102fca7","providerId":"0x85f85b8c071a5b2fea0eee7e0c824ace51ba469f","agreement":null},{"id":"R-da852661bd6c4a5df79c2f5faab4c1e343ede9e68a565b4b0d775b931d762abb","providerId":"0x85f85b8c071a5b2fea0eee7e0c824ace51ba469f","agreement":null}]},{"id":"0xc5bedb68059a3b38e48ff61fb124c370f7487b98","providerName":"unknown","proposals":[{"id":"R-7eb766a5c605d9a2ba71a0998767032c4de1b27859a63b384da0e1d167aa14b7","providerId":"0xc5bedb68059a3b38e48ff61fb124c370f7487b98","agreement":null}]},{"id":"0x7d2e5c5f845de0475585efaff754bc9c96b5fbf4","providerName":"unknown","proposals":[{"id":"R-4d9f501dc89fa55e02f68bf03f99846e3c06265d398bf8701e5bc3e3e699703d","providerId":"0x7d2e5c5f845de0475585efaff754bc9c96b5fbf4","agreement":null},{"id":"R-4a485397229c5bc3079bc0fe86487bf850e9abf8af8168068c6ddeb5410af052","providerId":"0x7d2e5c5f845de0475585efaff754bc9c96b5fbf4","agreement":null}]},{"id":"0xba09bd90bac4b6cfe30da4178f68c495a59fcbe1","providerName":"unknown","proposals":[{"id":"R-72c090756b25183a997e9c7f6e761cf288ff17e1c3869e3112b3d2042b4ef8ae","providerId":"0xba09bd90bac4b6cfe30da4178f68c495a59fcbe1","agreement":null},{"id":"R-8e0010efc57534d027bf1b7e27301add8c11e4c26a85ea5c618fba57a6ecfd4f","providerId":"0xba09bd90bac4b6cfe30da4178f68c495a59fcbe1","agreement":null}]},{"id":"0x18d3a6c5838c652be1c7b2fa92ac0d7353f5e8fe","providerName":"unknown","proposals":[{"id":"R-0c36478b07d06d1977599fb4abbc1f6f4b95afd61e10cb474bc2624aea29ebb0","providerId":"0x18d3a6c5838c652be1c7b2fa92ac0d7353f5e8fe","agreement":null},{"id":"R-b7c5521f20450a32e5cbf04fb548ee13eda194a79a27f385bdc95e23a4e0e31d","providerId":"0x18d3a6c5838c652be1c7b2fa92ac0d7353f5e8fe","agreement":null}]},{"id":"0x595c0c352dd0de2ec805ac39cff70fcddbecab12","providerName":"unknown","proposals":[{"id":"R-24f2416f1ce7c1b38d4108df5daff46443091a5a47ed571d7fbfa65c12ca8dee","providerId":"0x595c0c352dd0de2ec805ac39cff70fcddbecab12","agreement":null},{"id":"R-d561399f2db7ff946665c2f2c03f520680cb9e471bef81d6c3e05bf08119de53","providerId":"0x595c0c352dd0de2ec805ac39cff70fcddbecab12","agreement":null}]},{"id":"0xfd63f54df8dda960f5ee69058875fe979c7676da","providerName":"unknown","proposals":[{"id":"R-4c53d827ad45beaa963034d962038fa072a9ce2ca1bef1673fc63c62db67e364","providerId":"0xfd63f54df8dda960f5ee69058875fe979c7676da","agreement":null}]},{"id":"0xd385526f0a2d9165ba9aa704f4b9f33e85f7e8c2","providerName":"unknown","proposals":[{"id":"R-b8e74c737fc9adec4bb7bc5102bf8662d0b5461c2dec336be5136ca18062a3ef","providerId":"0xd385526f0a2d9165ba9aa704f4b9f33e85f7e8c2","agreement":null},{"id":"R-077320ed7237fcba0f7f291aae1672832cacbbc2b131db0d5b6fe7a1f71b282b","providerId":"0xd385526f0a2d9165ba9aa704f4b9f33e85f7e8c2","agreement":null}]},{"id":"0x6b3b050959aacc3666932852ee34eb290ce15111","providerName":"unknown","proposals":[{"id":"R-6767641c33d89b96d10ab91242b198d416a9490e91718a014ddfe4efd4f3f829","providerId":"0x6b3b050959aacc3666932852ee34eb290ce15111","agreement":null}]},{"id":"0x7ea10e5b7f76f973c753dc63928f1365f48a63c5","providerName":"unknown","proposals":[{"id":"R-ca53a0c546034b2d21d9372e275389827eeee8dc1c9a0dceab984b668d0b2b30","providerId":"0x7ea10e5b7f76f973c753dc63928f1365f48a63c5","agreement":null}]},{"id":"0x41a881d180f9b83a93bf54ffa487a609dd7e3ef1","providerName":"unknown","proposals":[{"id":"R-b44d45eea47dd576d82e19b9382c12d4d8e442d0c15cf104e8a59b1091537e19","providerId":"0x41a881d180f9b83a93bf54ffa487a609dd7e3ef1","agreement":null},{"id":"R-90a294d5a7aa12aef75d792ed5a322900f3981672db4e167f0c886fcbd43ccf0","providerId":"0x41a881d180f9b83a93bf54ffa487a609dd7e3ef1","agreement":null}]},{"id":"0xb8337a8a6036125b33eebe64bd1f2cd224a1555b","providerName":"unknown","proposals":[{"id":"R-bf2831d61402ce473551b49001757179158d1e2e6765d9f7523aecefc4d63471","providerId":"0xb8337a8a6036125b33eebe64bd1f2cd224a1555b","agreement":null}]},{"id":"0xd0319089e4b6c41ff0950c214c951bdf0516893b","providerName":"unknown","proposals":[{"id":"R-7f91002336a1a43d58733b0cddf5a44ced0e96059a50b60f73f101567dc0d1fa","providerId":"0xd0319089e4b6c41ff0950c214c951bdf0516893b","agreement":null},{"id":"R-20d2cf44297b2aad17caba700ecea9237787f7a4f4c83e44356851af3c399af8","providerId":"0xd0319089e4b6c41ff0950c214c951bdf0516893b","agreement":null}]},{"id":"0x2c7b400ca93bf23bc88d532a0f4ba5445e5bf520","providerName":"unknown","proposals":[{"id":"R-11be889a11d7abcd7b868b602bb9a1378bbb523a78a4a373f8b2e6932cf640fe","providerId":"0x2c7b400ca93bf23bc88d532a0f4ba5445e5bf520","agreement":null}]},{"id":"0xfd25f222f5debd48e7530f104a0ab2d2db7f9886","providerName":"unknown","proposals":[{"id":"R-b09388b9272184d30cde7f2f78f922295942e41e35dcbd8555ea61496c38f2f1","providerId":"0xfd25f222f5debd48e7530f104a0ab2d2db7f9886","agreement":null}]},{"id":"0x74835ba53e9bf894ab06d4ec9cc557d5fa8ecdbb","providerName":"unknown","proposals":[{"id":"R-6f085258ed6c2f3309df8fdaa81678927b52db273e631b54c29bbf0096d22208","providerId":"0x74835ba53e9bf894ab06d4ec9cc557d5fa8ecdbb","agreement":null},{"id":"R-9d7d8f814f7ef4868541c3bfdd3869590a4c656322e5025d27f0d9dbaedbe7f8","providerId":"0x74835ba53e9bf894ab06d4ec9cc557d5fa8ecdbb","agreement":null}]}]}'
// );
</script>
